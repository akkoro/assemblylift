name: AssemblyLift CI

on:
  push:
    branches: [ mainline, v0.3 ]
  pull_request:
    branches: [ mainline , v0.3 ]

jobs:

  build:
    name: 'AWS Lambda Runtime'
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v2
    - name: 'push to ECR @ akkoro-public'
      uses: appleboy/docker-ecr-action@master
      with:
        access_key: ${{ secrets.AWS_ACCESS_KEY_ID }}
        secret_key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
        dockerfile: docker/asml-lambda-build
        repo: public.ecr.aws/akkoro/assemblylift
        tags: "latest,$GITHUB_SHA"
